---
// Simple admin interface for editing content
import { readFileSync, writeFileSync } from 'fs';
import { join } from 'path';

let success = false;

if (Astro.request.method === 'POST') {
  try {
    const formData = await Astro.request.formData();
    const content = formData.get('content') as string;
    
    const filePath = join(process.cwd(), 'src/content/pages/home.md');
    writeFileSync(filePath, content);
    success = true;
  } catch (error) {
    console.error('Error saving file:', error);
  }
}

// Read current content
const filePath = join(process.cwd(), 'src/content/pages/home.md');
const currentContent = readFileSync(filePath, 'utf-8');
---

<html>
<head>
  <title>Simple Admin</title>
  <meta charset="utf-8">
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    textarea { width: 100%; height: 500px; font-family: monospace; }
    button { background: #0066cc; color: white; padding: 10px 20px; border: none; border-radius: 4px; margin-top: 10px; }
    .success { color: green; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Simple Content Editor</h1>
  
  {success && <p class="success">✅ Content saved successfully!</p>}
  
  <form method="post">
    <label for="content">Edit your homepage content:</label><br>
    <textarea name="content" id="content">{currentContent}</textarea><br>
    <button type="submit">Save Changes</button>
  </form>
  
  <p><a href="/">← Back to site</a> | <a href="/index-tina">View TinaCMS homepage</a></p>
</body>
</html>